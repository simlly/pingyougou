{"version":3,"sources":["goods_list.js"],"names":["$","goodsObj","query","cid","getUrl","pagenum","pagesize","TotalPage","init","mui","pullRefresh","container","down","auto","callback","cd","goodsData","html","template","arr","endPulldownToRefresh","refresh","getGoodsData","up","endPullupToRefresh","cb","append","get","result","meta","status","data","goods","Math","ceil","total","console","log","name","reg","RegExp","r","window","location","search","substr","match","decodeURI"],"mappings":"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","sourcesContent":["$(function () {\r\n    // 定义变量 存参数  发送请求需要带过去\r\n    let goodsObj = {\r\n        query: '',\r\n        cid: getUrl(\"cid\"),\r\n        pagenum: '1',   //第一页\r\n        pagesize: '5'    //显示几条数据\r\n    }\r\n    let TotalPage = 1;\r\n    init()\r\n    // mui上拉刷新下拉加载\r\n    function init() {\r\n        mui.init({\r\n            pullRefresh: {\r\n                container: \".pyg_view\",\r\n                down: {\r\n                    auto: true,\r\n                    //  触发下拉刷新时自动触发   初始化的时候刷新  生成页面标签\r\n                    callback: function () {\r\n                        let cd = function (goodsData) {\r\n                            let html = template('goodsTpl', { arr: goodsData });\r\n                            $('.goods_list').html(html);\r\n                            // 结束下拉刷新\r\n                            mui('.pyg_view').pullRefresh().endPulldownToRefresh();\r\n                            // 重置 组件\r\n                            mui('.pyg_view').pullRefresh().refresh(true);\r\n                            goodsObj.pagenum = 1;\r\n                        }\r\n                        getGoodsData(cd);\r\n                    }\r\n                },\r\n                up: {\r\n                    //  触发上拉刷新时自动触发\r\n                    callback: function () {\r\n                        // 判断当前是否>=最大的页数  是就结束上拉加载\r\n                        if (goodsObj.pagenum >= TotalPage) {\r\n                            mui(\".pyg_view\").pullRefresh().endPullupToRefresh(true);\r\n                        } else {\r\n                            goodsObj.pagenum++;\r\n                            // 数据回来之后\r\n                            let cb = function (goodsData) {\r\n                                let html = template(\"goodsTpl\", { arr: goodsData });\r\n                                // append 追加\r\n                                $(\".goods_list\").append(html);\r\n\r\n                                // 结束上拉组件\r\n                                // 结束上拉加载更多 如果没有数据 传入 true 否则 传入 false\r\n                                mui(\".pyg_view\").pullRefresh().endPullupToRefresh(false);\r\n                            };\r\n                            getGoodsData(cb);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        });\r\n\r\n    }\r\n    // 发送请求  获取商品列表的详细信息\r\n    function getGoodsData(cd) {\r\n        $.get(\"http://api.pyg.ak48.xyz/api/public/v1/goods/search\", goodsObj, (result) => {\r\n            if (result.meta.status == 200) {\r\n                // 请求成功  将数据渲染会页面\r\n                let goodsData = result.data.goods;\r\n                // 计算总页码\r\n                TotalPage = Math.ceil(result.data.total / goodsObj.pagesize);\r\n                cd(goodsData);\r\n            } else {\r\n                console.log('请求失败');\r\n            }\r\n        }\r\n        );\r\n\r\n    }\r\n    // 获取地址栏的参数  获取分类id\r\n    function getUrl(name) {\r\n        var reg = new RegExp(\"(^|&)\" + name + \"=([^&]*)(&|$)\", \"i\");\r\n        var r = window.location.search.substr(1).match(reg);\r\n        if (r != null) return decodeURI(r[2]);\r\n        return null;\r\n    }\r\n})"],"file":"goods_list.js"}