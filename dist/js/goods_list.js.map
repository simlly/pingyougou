{"version":3,"sources":["goods_list.js"],"names":["$","goodsObj","query","cid","getUrl","pagenum","pagesize","TotalPage","init","eventList","mui","pullRefresh","container","down","auto","callback","cd","goodsData","html","template","arr","endPulldownToRefresh","refresh","getGoodsData","up","endPullupToRefresh","cb","append","on","href","location","get","result","meta","status","data","goods","Math","ceil","total","console","log","name","reg","RegExp","r","window","search","substr","match","decodeURI"],"mappings":"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","sourcesContent":["$(function () {\r\n    // 定义变量 存参数  发送请求需要带过去\r\n    let goodsObj = {\r\n        query: '',\r\n        cid: getUrl(\"cid\"),\r\n        pagenum: '1',   //第一页\r\n        pagesize: '5'    //显示几条数据\r\n    }\r\n    let TotalPage = 1;\r\n    init()\r\n    // mui上拉刷新下拉加载\r\n    function init() {\r\n        eventList();\r\n        mui.init({\r\n            pullRefresh: {\r\n                container: \".pyg_view\",\r\n                down: {\r\n                    auto: true,\r\n                    //  触发下拉刷新时自动触发   初始化的时候刷新  生成页面标签\r\n                    callback: function () {\r\n                        let cd = function (goodsData) {\r\n                            let html = template('goodsTpl', { arr: goodsData });\r\n                            $('.goods_list').html(html);\r\n                            // 结束下拉刷新\r\n                            mui('.pyg_view').pullRefresh().endPulldownToRefresh();\r\n                            // 重置 组件\r\n                            mui('.pyg_view').pullRefresh().refresh(true);\r\n                            goodsObj.pagenum = 1;\r\n                        }\r\n                        getGoodsData(cd);\r\n                    }\r\n                },\r\n                up: {\r\n                    //  触发上拉刷新时自动触发\r\n                    callback: function () {\r\n                        // 判断当前是否>=最大的页数  是就结束上拉加载\r\n                        if (goodsObj.pagenum >= TotalPage) {\r\n                            mui(\".pyg_view\").pullRefresh().endPullupToRefresh(true);\r\n                        } else {\r\n                            goodsObj.pagenum++;\r\n                            // 数据回来之后\r\n                            let cb = function (goodsData) {\r\n                                let html = template(\"goodsTpl\", { arr: goodsData });\r\n                                // append 追加\r\n                                $(\".goods_list\").append(html);\r\n\r\n                                // 结束上拉组件\r\n                                // 结束上拉加载更多 如果没有数据 传入 true 否则 传入 false\r\n                                mui(\".pyg_view\").pullRefresh().endPullupToRefresh(false);\r\n                            };\r\n                            getGoodsData(cb);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        });\r\n       \r\n    }\r\n    // 因为在MUI框架中  会默认a标签不跳转   所以 用tap事件  跳转\r\n    function eventList(){\r\n        // a标签  绑定tap点击事件    (箭头函数this是不绑定的   或获取上下函数的this做自己的)\r\n        $('.goods_list').on('tap','a',function(){\r\n            let href=this.href;\r\n            location.href=href;\r\n            // console.log(this.href)\r\n        })\r\n       \r\n      \r\n    }\r\n    // 发送请求  获取商品列表的详细信息\r\n    function getGoodsData(cd) {\r\n        $.get(\"http://api.pyg.ak48.xyz/api/public/v1/goods/search\", goodsObj, (result) => {\r\n            if (result.meta.status == 200) {\r\n                // 请求成功  将数据渲染会页面\r\n                let goodsData = result.data.goods;\r\n                // 计算总页码\r\n                TotalPage = Math.ceil(result.data.total / goodsObj.pagesize);\r\n                cd(goodsData);\r\n            } else {\r\n                console.log('请求失败');\r\n            }\r\n        }\r\n        );\r\n\r\n    }\r\n    // 获取地址栏的参数  获取分类id\r\n    function getUrl(name) {\r\n        var reg = new RegExp(\"(^|&)\" + name + \"=([^&]*)(&|$)\", \"i\");\r\n        var r = window.location.search.substr(1).match(reg);\r\n        if (r != null) return decodeURI(r[2]);\r\n        return null;\r\n    }\r\n})"],"file":"goods_list.js"}