{"version":3,"sources":["category.js"],"names":["$","CateDatas","init","categoies","eventList","sseionStr","sessionStorage","getItem","sessObj","JSON","parse","Date","now","time","data","leftData","rightData","params","on","addClass","siblings","removeClass","index","get","result","meta","status","sseionObj","setItem","stringify","console","log","html","i","length","cat_name","leftScroll","IScroll","item2Obj","children","template","arr","imgLength","rightScroll"],"mappings":"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","sourcesContent":["$(function () {\r\n    let CateDatas;\r\n    init();\r\n    function init() {\r\n        categoies();\r\n        eventList();\r\n    }\r\n    // 判断有没有缓存\r\n    let sseionStr = sessionStorage.getItem('cates');\r\n    // 把缓存数据 重新解析成 对象格式\r\n    let sessObj = JSON.parse(sseionStr);\r\n    if (!sseionStr) {\r\n        categoies();\r\n    } else {\r\n        // 如果有缓存  看是否失效\r\n        if (Date.now() - sessObj.time > 500000) {\r\n            categoies();\r\n        } else {\r\n            CateDatas = sessObj.data;\r\n            // 左右渲染\r\n            leftData();\r\n            rightData(0);\r\n        }\r\n\r\n    }\r\n\r\n\r\n\r\n    // 绑定点击事件\r\n    function eventList(params) {\r\n        $(\".left_menu \").on(\"tap\", \"li\", function () {\r\n            $(this).addClass(\"active\").siblings().removeClass(\"active\");\r\n            // 获取 被点击的li标签的索引 $(this).index()\r\n            let index = $(this).index();\r\n            rightData(index);\r\n\r\n        })\r\n    }\r\n\r\n    // 发送一次请求    获取到数据 \r\n    function categoies() {\r\n        $.get(\"http://api.pyg.ak48.xyz/api/public/v1/categories\", (result) => {\r\n            if (result.meta.status == 200) {\r\n                CateDatas = result.data;\r\n                // 会话存储\r\n                let sseionObj = {\r\n                    data: CateDatas,\r\n                    time: Date.now()\r\n                }\r\n                // 千万要将对象转换成字符串  在存进去\r\n                sessionStorage.setItem(\"cates\", JSON.stringify(sseionObj));\r\n                // 渲染左边\r\n                leftData();\r\n                // 右边页面的渲染\r\n                rightData(0);\r\n            } else {\r\n                console.log('请求失败');\r\n            }\r\n\r\n        }\r\n        );\r\n\r\n    }\r\n    // 左边的渲染\r\n    function leftData() {\r\n\r\n        let html = '';\r\n        // console.log(html)\r\n        for (let i = 0; i < CateDatas.length; i++) {\r\n            html += `<li class=\"${i == 0 ? \"active\" : \"\"}\">${CateDatas[i].cat_name}</li>`\r\n        }\r\n        $('.left_menu').html(html);\r\n        var leftScroll = new IScroll('.left_box');\r\n    }\r\n    // 右边页面的渲染\r\n    function rightData(index) {\r\n        // 根据索引值  获取到对应的数据\r\n        let item2Obj = CateDatas[index];\r\n        let rightData = item2Obj.children;\r\n        let html = template('cateTpl', { arr: rightData })\r\n        $('.right_box').html(html);\r\n\r\n\r\n        // 判断图片是否加载完毕  然后初始化iscroll(图片加载事件)\r\n        let imgLength=$('.item_list img').length;\r\n        \r\n        $('.item_list img').on('load',()=>{\r\n            imgLength--;\r\n            console.log(imgLength)\r\n            if(imgLength==0){\r\n                var rightScroll = new IScroll('.right_box');\r\n            }\r\n        })\r\n        \r\n    }\r\n})"],"file":"category.js"}