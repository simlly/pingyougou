{"version":3,"sources":["goods_detail.js"],"names":["$","GoodsObj","init","goodsDetail","eventList","get","goods_id","getUrl","result","console","log","meta","status","cat_id","data","goods_name","goods_number","goods_price","goods_small_logo","goods_weight","html","template","gallery","mui","slider","interval","on","userinfo","sessionStorage","getItem","toast","setInterval","setItem","location","href","token","JSON","parse","ajax","type","url","info","stringify","headers","Authorization","success","confirm","editType","index","name","reg","RegExp","r","window","search","substr","match","decodeURI"],"mappings":"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","sourcesContent":["$(function () {\r\n    let GoodsObj = {};\r\n    init();\r\n    function init() {\r\n        goodsDetail();\r\n        eventList();\r\n    }\r\n    // 请求商品详情的数据\r\n    function goodsDetail() {\r\n        $.get(\"http://api.pyg.ak48.xyz/api/public/v1/goods/detail\", { goods_id: getUrl('goods_id') },\r\n            function (result) {\r\n                console.log(result);\r\n                if (result.meta.status == 200) {\r\n                    // 获取下添加到购物车  需要用到的商品对象的属性\r\n                    GoodsObj = {\r\n                        cat_id: result.data.cat_id,\r\n                        goods_id: result.data.goods_id,\r\n                        goods_name: result.data.goods_name,\r\n                        goods_number: result.data.goods_number,\r\n                        goods_price: result.data.goods_price,\r\n                        goods_small_logo: result.data.goods_small_logo,\r\n                        goods_weight: result.data.goods_weight\r\n                    };\r\n                    //   debugger;\r\n                    let data = result.data;\r\n                    let html = template('detailTpl', data);\r\n                    $('.pyg_view').html(html);\r\n                    // 轮播图初始化\r\n                    var gallery = mui('.mui-slider');\r\n                    gallery.slider({\r\n                        interval: 3000//自动轮播周期，若为0则不自动播放，默认为0；\r\n                    });\r\n                } else {\r\n                    console.log('请求失败')\r\n                }\r\n\r\n            }\r\n        );\r\n    }\r\n\r\n\r\n    function eventList() {\r\n        // 给购物车 绑定tap点击 事件\r\n        $(\".shopping_car_btn\").on(\"tap\", function () {\r\n            // 判断会话存储有没有userinfo的信息\r\n            let userinfo = sessionStorage.getItem('userinfo');\r\n            // console.log(userinfo)\r\n            if (!userinfo) {\r\n                mui.toast('没有注册')\r\n                setInterval(() => {\r\n                    //  点击购物车没有登录的话  就先跳到登录页面  并把当前页的地址存起来\r\n                    sessionStorage.setItem('pageurl', location.href);\r\n                    location.href = 'login.html';\r\n                }, 1000);\r\n            } else {\r\n                // 登录过  就发送请求\r\n                // token 从本地存储里获取\r\n                let token = JSON.parse(userinfo).token;\r\n                $.ajax({\r\n                    type: \"post\",\r\n                    url: \"http://api.pyg.ak48.xyz/api/public/v1/my/cart/add\",\r\n                    data: {\r\n                        info: JSON.stringify(GoodsObj)\r\n                    },\r\n                    headers: {\r\n                        Authorization: token\r\n                    },\r\n                    success: function (result) {\r\n                        console.log(result);\r\n                        // 成功后是否跳转到购物车页面\r\n                        if (result.meta.status == 200) {\r\n                            mui.confirm(\"您是否要跳转到购物车页面？\", \"添加成功\", [\"跳转\", \"取消\"], function (editType) {\r\n                                if(editType.index==0){\r\n                                    location.href='cart.html'\r\n                                }else if(editType.index==1){\r\n\r\n                                }\r\n\r\n                            })\r\n                        }else{\r\n                            console.log(\"请求失败\")\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        })\r\n\r\n    }\r\n\r\n    // 获取地址栏的参数  获取分类id\r\n    function getUrl(name) {\r\n        var reg = new RegExp(\"(^|&)\" + name + \"=([^&]*)(&|$)\", \"i\");\r\n        var r = window.location.search.substr(1).match(reg);\r\n        if (r != null) return decodeURI(r[2]);\r\n        return null;\r\n    }\r\n\r\n})"],"file":"goods_detail.js"}